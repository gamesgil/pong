window.Gil||(window.Gil={}),window.onload=function(){const b="playing",f="gameOver";let g="paused";Gil.Controller=function(){return{init:()=>{Gil.View.init();let h=new Timer;h.start(3,function(){g=b,Gil.View.setText("")}),setInterval(function(){Gil.View.update(Gil.Game.getPlayerScore(),Gil.Game.getCpuScore())},1e3/30)},waitBeforeProceed:()=>{if(console.log(g),g!=f){const h=new Timer;h.start(3,function(){Gil.View.resetBall(),Gil.View.setText(""),g=b})}},playerScores:()=>{Gil.Game.addPlayerScore(1),Gil.Controller.checkGameOver()},cpuScores:()=>{Gil.Game.addCpuScore(1),Gil.Controller.checkGameOver()},checkGameOver:()=>{3===Gil.Game.getPlayerScore()||3===Gil.Game.getCpuScore()?(g=f,Gil.Game.getPlayerScore()>Gil.Game.getCpuScore()?Gil.View.setText("Player Wins. Game Over!"):Gil.View.setText("CPU Wins. Game Over!")):(g="outOfBounds",Gil.View.setText("Get Ready..."))}}}(),Gil.View=function(){function h(x,y){let z=g==b?r.x+u.x*s.x:r.x,A=g==b?r.y+u.y*s.y:r.y;~function(){k.clearRect(0,0,j.width,j.height),k.fillStyle="black",k.fillRect(0,0,j.width,j.height),Gil.Gui.drawPlayfield(),Gil.Gui.drawScore(x,y),Gil.Gui.drawText(w)}(),~function(){k.fillStyle="white",k.fillRect(m,p,n,o)}(),~function(){k.fillStyle="white",k.fillRect(j.width-m,q,n,o),g==b&&(q+o/2<A?q+=v:q+o/2>A&&(q-=v))}(),~function(){g==b&&(k.fillStyle="white",k.fillRect(r.x,r.y,l,l),~function(){(z>j.width-l||0>z)&&(z>j.width-l?Gil.Controller.playerScores():Gil.Controller.cpuScores(),Gil.Controller.waitBeforeProceed())}()),~function(){(A>j.height-l/2||0>A)&&(A=A>j.height-l?j.height-l:0,u.y=-u.y)}(),~function(){let D,E;z<j.width/2?(D=m+n,E=p,z<=D&&A>=E&&A<=E+o&&(z=D,u.x=1,u.y=A<=E+o/2?-1:1,s.x+=0.5,s.y+=0.5)):(D=j.width-m,E=q,z>=D&&A>=E&&A<=E+o&&(z=D,u.x=-1,u.y=A<=E+o/2?-1:1,s.x+=0.5,s.y+=0.5))}(),r.x=z,r.y=A}()}function i(x){g==b&&(p=x.offsetY)}const j=document.getElementById("canvas"),k=j.getContext("2d");let l=j.width/40,m=j.width/10,n=j.width/50,o=j.height/4,p=(j.height-o)/2,q=p,r={x:0,y:0},s={x:15,y:15},u={x:-1,y:1},v=4,w="Pong - an original game by Gil Steiner";return{init:()=>{j.style.width="100%",j.style.height="100%",j.width=j.offsetWidth,j.height=j.offsetHeight,Gil.Gui.init(j,k),Gil.View.resetBall(),document.addEventListener("mousemove",i)},update:(x,y,z)=>{h(x,y,z)},resetBall:()=>{s={x:5,y:5},r={x:(j.width-l)/2,y:(j.height-l)/2}},setText:x=>{w=x}}}(),Gil.Game=function(){let h=0,i=0;return{addPlayerScore:j=>{h+=j},getPlayerScore:()=>h,addCpuScore:j=>{i+=j},getCpuScore:()=>i}}(),Gil.Controller.init()};